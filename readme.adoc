# Multi-Agent Oriented Programming Tutorial
:toc: right
:author: 23rd European Agent Systems Summer School
:date: July 2023
:source-highlighter: coderay
:coderay-linenums-mode: inline
:icons: font
:prewrap!:

This guide contains practical material for the tutorial _Multi-Agent Oriented Programming_ at https://easss23.fit.cvut.cz[23rd European Agent Systems Summer] School, 2023, Prague.


== Smart Room Scenario

The objective is to develop an MAOP system to control the temperature of a room so that it reaches some desired temperature

* The room is equipped with a "Heating, Ventilating and Air  Conditioning" (HVAC), that provides

** the current room temperature
** operations to start cooling, start heating, and stop the machine

* initially we have one agent that has the goal of maintaining a certain temperature

image:doc/figs/smart-room1.png[]


== Agent Dimension (Lab 1)

=== Task 1: run the the initial project for the smart room scenario

The simplest way to run the examples and do the exercises is by using https://gitpod.io/#https://github.com/JaCaMo-EASSS23/code[GitPod, following this link] (a github account is required). You can also work locally by cloning locally the repository https://github.com/JaCaMo-EASSS23/code. Java and VSCode should be installed in this case.

To run the initial project, type the commands below in the terminal:
----
cd lab1/smart-room-sa
./gradlew
----

You can see how the system react to changes in temperature by opening another terminal and executing the command:

----
curl -X POST  http://localhost:8080/workspaces/room/artifacts/hvac/properties/temperature -H 'Content-Type: application/json' -d '[ 10 ]'
----

replacing the last number 10 by the current temperature of the room.


=== Task 2: Reading and understanding agent programs

* Exercise 1: open the code of the room controller agent (file `src/agt/room_controller.asl`), read the code and identify the beliefs, goals, and plans. Try to map the program to the observed behavior. 

* Exercise 2: open the _mind inspector_ for agent `rc` and compare the beliefs there with those identified in the program. Are they the same? Are represented the same way? 

* Exercise 3: change the program so that the target temperature is 15.

=== Task 3: Improve the implementation

* Exercise 4: add a new plan to print the current state of the HVAC.

* Exercise 5: change the plans of previous exercise so that when the hvac state is `"cooling"` it is printed "so cool" and, when the state is `"heating"` it is printed "so hot".

* Exercise 6: open the project in folder `lab1/e6` and take a look at the room controller program. There is a difference in the last lines (line 17). Evaluate the reasons for that modification and the its problems. Some ideas about how to fix? (no need to develop the solution in Jason.)

* Exercise 7: open the project in folder `lab1/e7` and take a look at the room controller program. The target temperature is as an argument of goal `keep_temperature`. The project, as it is, works. But what happens if a line like `!keep_temperature(35)` is added in the program? Explain the behavior produced buy this change.


== Agent (Communication) Dimension (Lab 2)

----
cd lab2/smart-room-ma
./gradlew
----

- example of askOne sync and async

- [give some with signal, ask to change to tell and notice the difference]

- [case of many source and belief removal]

- [case of source of sources]

- [increment id]

- [use DF to find participants]

- [implement timeout]


- [initial impl is not the voting, it is a consensus based on average. add call for candidates step, then options in open voting, pa choose, rc select the most voted]


== Environment Dimension (Lab 3)

=== Task 1: Implement a usage interface for the voting machine
- [define observable property `status` (with values `open`/`closed`) in the artifact's `init` method]
- [implement operations for: `open`, `vote`, and `close`]

=== Task 2: Instantiate and use a voting machine
- [complete plan(s) for creating, starting, and stopping the voting machine]
- [complete plan(s) for focusing on the voting machine and bidding]

=== Task 3: Implement automatic closing with a countdown
- [implement an internal operation for closing the voting machine with a countdown]

== Organisation Dimension (Lab 4)

